var processing_Json = {
	"machin1": {
    	"machinNum":"1-E-10254-PT100-1",
		"startTime":"2017-04-18 09:20:14",
		"modelName":"模板名称1",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-04-18 09:30:25"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-04-22 11:10:08"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-04-23 14:05:36"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-04-25 10:40:12"
           	},
           	{
        	   "stepName":"工序名称5",
        	   "stepTime":"2017-04-27 16:18:38"
           	}
		]
    },
	"machin2":{
    	"machinNum":"1-E-10254-PT100-2",
		"startTime":"2017-05-06 08:30:02",
		"modelName":"模板名称2",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-05-16 10:24:21"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-05-17 11:26:33"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-05-19 15:15:17"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-05-20 18:11:47"
           	}
		]
    },
	"machin3":{
    	"machinNum":"1-E-10254-PT100-3",
		"startTime":"2017-06-25 09:35:53",
		"modelName":"模板名称3",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-06-25 13:49:13"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-06-26 10:36:18"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-06-28 17:14:21"
           	}
		]
    }
	
};
var yearMonth="{2016=[11-12],2017=[01-02]}";
var processed_Json={
	"machin4": {
    	"machinNum":"1-E-10254-PT100-4",
		"startTime":"2016-11-04 09:29:34",
		"modelName":"模板名称4",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2016-11-04 10:12:10"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2016-11-05 16:58:51"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2016-11-07 09:38:47"
           	}
		]
    },
	"machin5":{
    	"machinNum":"1-E-10254-PT100-5",
		"startTime":"2016-12-14 09:47:33",
		"modelName":"模板名称5",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2016-12-14 15:26:50"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2016-12-15 08:11:57"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2016-12-16 14:39:12"
           	}
		]
    },
    "machin6":{
    	"machinNum":"1-E-10254-PT100-6",
		"startTime":"2016-12-19 09:47:33",
		"modelName":"模板名称6",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2016-12-20 15:26:50"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2016-12-21 08:11:57"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2016-12-22 14:39:12"
           	}
		]
    },
	"machin7":{
    	"machinNum":"1-E-10254-PT100-7",
		"startTime":"2017-01-05 10:11:45",
		"modelName":"模板名称7",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-01-06 12:31:09"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-01-07 09:20:52"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-01-09 13:42:27"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-01-11 15:17:38"
           	},
           	{
        	   "stepName":"工序名称5",
        	   "stepTime":"2017-01-13 15:17:38"
           	}
		]
   	},
   	"machin8":{
    	"machinNum":"1-E-10254-PT100-8",
		"startTime":"2017-01-16 10:11:45",
		"modelName":"模板名称8",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-01-16 12:31:09"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-01-17 09:20:52"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-01-09 13:42:27"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-01-10 15:17:38"
           	}
		]
   	},
   "machin9":{
    	"machinNum":"1-E-10254-PT100-9",
		"startTime":"2017-01-20 10:11:45",
		"modelName":"模板名称9",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-01-21 12:31:09"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-01-22 09:20:52"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-01-24 13:42:27"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-01-26 15:17:38"
           	}
		]
   },
   "machin10":{
    	"machinNum":"1-E-10254-PT100-10",
		"startTime":"2017-02-21 09:35:53",
		"modelName":"模板名称10",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-02-21 13:49:13"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-02-22 10:36:18"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-02-23 17:14:21"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-02-25 17:14:21"
           	},
           	{
        	   "stepName":"工序名称5",
        	   "stepTime":"2017-02-28 11:22:28"
           	}
		]
   	},
   	"machin11":{
    	"machinNum":"1-E-10254-PT100-11",
		"startTime":"2017-02-25 09:35:53",
		"modelName":"模板名称11",
		"machinList":[
           	{
        	   "stepName":"工序名称1",
        	   "stepTime":"2017-02-26 13:49:13"
           	},
           	{
        	   "stepName":"工序名称2",
        	   "stepTime":"2017-02-27 10:36:18"
           	},
           	{
        	   "stepName":"工序名称3",
        	   "stepTime":"2017-02-28 17:14:21"
           	},
           	{
        	   "stepName":"工序名称4",
        	   "stepTime":"2017-02-29 17:14:21"
           	},
           	{
        	   "stepName":"工序名称5",
        	   "stepTime":"2017-02-30 11:22:28"
           	}
		]
   	}
};
//进行中的加工
var data = processing_Json;
var proJsonObj=[];
for(var a in data){
	var rs = eval("data." + a);
	proJsonObj.push(rs);
};
var jsonLength=proJsonObj.length;
//进行中的加工
//年月
var timeData = yearMonth;
var arryY=[];
var timeArr=(timeData.substring(1,timeData.length-1)).split(",");

for(var i=0;i<timeArr.length;i++){
	var getY=timeArr[i].split("=")[0];
	arryY.push(getY);
}
//年月
//已完成的加工
var fData = processed_Json;
var finshJsonObj=[];
for(var a in fData){
	var rf = eval("fData." + a);
	finshJsonObj.push(rf);
};
var finshLength=finshJsonObj.length;
//已完成的加工
$(function() {
	getProcessing();
	//展开模块选择列表
	$(".modelBox").click(function() {
		var ifSelect=$(".modelBox").attr("ifSelect");
		if(ifSelect=="0"){
			$(".modelBox").addClass("modelBoxActive");
			$(".modelList").stop().slideDown(400);
			$(".modelBox").attr("ifSelect","1");
		}else{
			$(".modelList").stop().slideUp(400);
			setTimeout(function () {
		        $(".modelBox").removeClass("modelBoxActive");
		    },400);
			$(".modelBox").attr("ifSelect","0");
		}
	});
	//点击模板列表跳转
	$(document).on('click', '.modelList li', function(){
		$(this).addClass('haveClick').siblings().removeClass('haveClick');
		var getModelName=$(this).html();
		location.href=encodeURI("continue_process.html?modelName=" + getModelName);
	});
	//切换进行中和已完成tab
	$(".proSituationTit div").click(function(){
		$(this).addClass('act1').siblings().removeClass('act1');
		var num =$(this).index();
		$(".machList").html("");
		$(".finishList").html("");
		$(".modelCont").hide();
		if(num==1){
			$(".chooseTime").show();
		}else{
			$(".selectY").val("0");
			$(".selectM").val("0");
			$(".chooseTime").hide();
			getProcessing();
			$(".chooseTime").css("margin-bottom","0");
		}
	});
	//点击进行中的加工单号出现弹出框
	$(document).on('click', '.machList li', function(){
		$(this).addClass('act').siblings().removeClass('act');
		var getIndex=$(this).index();
		var getModelName=$(this).find(".modelName").html();
		$(".do_pro_pop li").eq(1).attr("getModelName",getModelName);
		$(".modelTitInner").attr("getIndex",getIndex);
		var getProNum=$(this).find(".machNum").html();
		$(".do_pro_pop li").eq(0).attr("getProNum",getProNum);
		$(".mask").show();
		$(".do_pro_pop").stop().slideDown(400);
		$(".modelCont").hide();
	});
	//点击已完成的加工单列表直接出现工序步骤
	var thes=0;
//	var stopNum=0;
//	var timeNum = 0;
	$(document).on('click', '.finishList li', function(){
		var getProNum=$(this).find(".machNum").html();
//		if(stopNum==getProNum){
//			return false;
//		}
		
//		var thisTime=new Date();
//		var thisTimeNum=thisTime.getTime();
//		console.log(thisTimeNum-timeNum);
//		if(thisTimeNum-timeNum<1000){
//			return false;
//		}
//		timeNum=thisTimeNum;
		
		$(this).addClass('act').siblings().removeClass('act');
		var getIndex=$(this).index();
		$(".modelTitInner").attr("getIndex",getIndex);

		
//		stopNum=getProNum;
		if(thes==0){
   			getStep(getProNum,"f");
   			thes=1;
   		}else{
   			$(".modelCont").stop(true, true).slideUp(400);
   			setTimeout(function () {
				getStep(getProNum,"f");
			},410);
   		}
        
	});
	//点击回到导航
	$(".modelTitInner").click(function(){
		var index=$(this).attr("getindex");
		goToNav(index);
	});
	//点击遮罩
	$(".mask").click(function(){
		$(".machList li").removeClass('act');
		$(".finishList li").removeClass('act');
		$(".do_pro_pop").stop().slideUp(400);
		$(".mask").hide();
	});
	//点击选择历史记录or跳转页面
	$(document).on('click', '.do_pro_pop li', function(){
	    $(".do_pro_pop").stop().slideUp(300);
		$(".mask").hide();
		var cNum =$(this).index();
	    if(cNum==0){
	    	
	    	var getProNum=$(this).attr("getProNum");
	    	getStep(getProNum,"m");
	    	$(".modelCont").css("height","auto");
	    	setTimeout(function () {
		        $(".modelCont").stop().slideDown(400,function(){
		        	$(".modelCont").css("height","auto");
		        	goToCont('modelTitInner');
		        });
		    },300);
		    
	    }else{
	    	var getModelName=$(this).attr("getModelName");
	    	location.href=encodeURI("continue_process.html?modelName=" + getModelName);
	    }
	});
	//点击工序列表出现工序详情
	$(document).on('click', '.stepList li', function(){
		$(this).addClass('act').siblings().removeClass('act');
		$(".mask").show();
		$(".proCont_pop").slideDown(400);
		$(".proCont_pop_footer").slideDown();
	})
	$(".proCont_pop_footer").click(function(){
		$(".stepList li").removeClass('act');
		$(".proCont_pop").slideUp(400);
		$(".proCont_pop_footer").slideUp();
		$(".mask").hide();
	});
	//已完成的加工选择年月出现记录列表
	//切换年份
	var thef=0;
	$(".selectY").change(function(){ 
		var getYear = $(".selectY").val();
		thef=0;
		thes=0;
		$(".selectM").html("");
		$(".finishList").stop().slideUp(400);
		$(".modelCont").stop().slideUp(400);
		setTimeout(function () {
			$(".chooseTime").css("margin-bottom","0");
		},400);
		
		$(".selectM").append("<option value='0'>- - 选择月份 - -</option>");
		getMonth(getYear);
	});
	//切换月份
	
	$(".selectM").change(function(){ 
	    var getMonth=$(this).val();
	    thes=0;
	    $(".modelCont").stop().slideUp(400);
	    var getYear=$(".selectY").val();
	    if(getMonth!="0"){
	    	$(".chooseTime").css("margin-bottom","0.41666667rem");
	   		if(thef==0){
	   			getProcessed(getYear,getMonth);
	   			thef=1;
	   		}else{
	   			$(".finishList").stop().slideUp(400);
	   			setTimeout(function () {
		    		getProcessed(getYear,getMonth);
		    	},410);
	   		}
	    	
	    }else{
	    	$(".finishList").stop().slideUp();
	    	$(".finishList").html("");
	    	$(".chooseTime").css("margin-bottom","0");
	    }
	});
//	//弹出tab切换居中
//	var tabHeight=$(".do_pro_pop").height()/2;
//	$(".do_pro_pop").css("margin-top",-tabHeight);
//	//弹出tab切换——查看历史/跳转加工
//	$(".tabBtn div").click(function(){
//		var divNum=$(this).index();
//		var txtHeight=($(".historyInner").height()+(60/72+1)*num)/2;
//		var btnHeight=($(".goBtn").height()+(60/72+1)*num)/2;
//		$(this).addClass("tabActive").siblings().removeClass("tabActive");
//		if(divNum==0){
//			$(".goBtn").hide();
//			$(".do_pro_pop").css("margin-top",-txtHeight);
//			$(".historyInner").show();
//		}else{
//			$(".historyInner").hide();
//			$(".do_pro_pop").css("margin-top",-btnHeight);
//			$(".goBtn").css("display","table");
//		}
//	})

//————————————————————————————————筛选————————————————————————————————
	
	//获取场地和模板
	getModel();
	getPlace();
	
	//展示侧边栏
	$(".showNavIcon").click(function(){
		$(".navMask").show();
		$(".showNavIcon").stop().slideUp();
		$(".navList").addClass("navShow");
		$(".listBtn").addClass("BtnShow");
		$(".listTit").addClass("BtnShow");
	})
	
	//点击遮罩
	$(".navMask").click(function(){
		hideNav();
	});
	
	//点击大标题,展示列表
	$(".navTit").click(function(){
		$(this).find('img').toggleClass('imgclick');
		$(this).next('.curBox').slideToggle();
	});
	
	//选择li
	var timeNum = 0;
	$(".lateralNav").on("click","#cPlace .navListBox li",function(){ 
		var thisTime=new Date();
		var thisTimeNum=thisTime.getTime();
		if(thisTimeNum-timeNum<600){
			return false;
		}
		timeNum=thisTimeNum;
		var getID = $(this).attr('id');
		var obj = $(this);
		getPlace(getID,obj);
		
	});
	var timeNum1 = 0;
	$(".lateralNav").on("click","#cModel .navListBox li",function(){ 
		var thisTime=new Date();
		var thisTimeNum=thisTime.getTime();
		if(thisTimeNum-timeNum1<600){
			return false;
		}
		timeNum1=thisTimeNum;
		var obj = $(this);
		var getID = $(this).attr('id');
		getModel(getID,obj);
	});
	$(".lateralNav").on("click","#cSonPlace .navListBox li",function(){ 
		var obj = $(this);
		showSon(obj,1);
	});
	$(".lateralNav").on("click","#cProcess .navListBox li",function(){ 
		var obj = $(this);
		showSon(obj,1);
	});
	
	//重置
	$(".restart").click(function(){
		$(".navListBox li").removeClass('liClick');
		$(".curBox").stop().slideUp();
		$(".navTit").find('img').removeClass('imgclick');
		$("#cSonPlace").slideUp();
		$("#cProcess").slideUp();
		$("#cPlace .navTit").find('span').html('选择场地');
		$("#cSonPlace .navTit").find('span').html('选择子场地');
		$("#cModel .navTit").find('span').html('选择模板');
		$("#cProcess .navTit").find('span').html('选择工序');
	});
	
	//确定
	$(".listComfirm").click(function(){
		hideNav();
		//
		var screenJson = [];
		var getPlace = $(".cPlaceList").find(".liClick").attr('id');
		var getSPlace = $(".cSonPlaceList").find(".liClick").attr('id');
		var getModel = $(".cModelList").find(".liClick").attr('id');
		var getProcess = $(".cProcessList").find(".liClick").attr('id');
		if(!getPlace){
			getPlace = null;
		}
		if(!getSPlace){
			getSPlace = null;
		}
		if(!getModel){
			getModel = null;
		}
		if(!getProcess){
			getProcess = null;
		}
		screenJson.push("{'siteId':"+getPlace+",'childSiteId':"+getSPlace+",'tempId':"+getModel+",'prcdId':"+getProcess+"}");
		$("#screenObj").val(screenJson);
	})
//————————————————————————————————筛选————————————————————————————————
})
//隐藏模板列表
function hideModel(){
	$(".modelList").stop().slideUp();
	setTimeout(function () {
        $(".modelBox").removeClass("modelBoxActive");
    },400);
	$(".modelBox").attr("ifSelect","0");
}
//默认加载进行中的加工单号列表
function getProcessing(){
	var phtml="";
	for(var i=0;i<jsonLength;i++){
		phtml+="<li>";
		phtml+="<div class=\"machNum\">"+proJsonObj[i].machinNum+"</div>";
		phtml+="<div class=\"modelName\">"+proJsonObj[i].modelName+"</div>";
		phtml+="<div class=\"mach_s_time\">"+proJsonObj[i].startTime+"</div>";
		phtml+="</li>";
	}
	$(".machList").html(phtml);
}
//获取每个加工单号对于的工序步骤
function getStep(getProNum,proState){
	var shtml="";
	var thisIndex="";
	var stepBox=[];
	if(proState=="m"){
		stepBox=proJsonObj;
	}else if(proState=="f"){
		stepBox=finshJsonObj;
	}
	for(var i=0;i<stepBox.length;i++){
		if(stepBox[i].machinNum==getProNum){
			thisIndex=i;
			$(".modelTitInner").html("↑ "+stepBox[thisIndex].modelName+"（"+getProNum+"） ↑");
			for(var a=0;a<stepBox[i].machinList.length;a++){
				shtml+="<li>";
				shtml+="<div class=\"stepNum\">"+stepBox[i].machinList[a].stepName+"</div>";
				shtml+="<div class=\"step_time\">"+stepBox[i].machinList[a].stepTime+"</div>";
				shtml+="</li>";
			}
		}
	}
	$(".stepList").html(shtml);
	$(".modelCont").css("height","auto");
	$(".modelCont").stop().slideDown(function(){
		$(".modelCont").css("height","auto");
    	goToCont('modelTitInner');
    });
}
//获取当前选择年份拥有的月份
function getMonth(getYear){
	for(var i=0;i<arryY.length;i++){
		if(arryY[i]==getYear){
			var month = timeArr[i].split("=")[1];	
			var monthStr = month.substring(1,month.length-1);	
			var monthArr = monthStr.split("-");
			for(var mon=0;mon<monthArr.length;mon++){
				$(".selectM").append("<option value='"+monthArr[mon]+"'>"+monthArr[mon]+"月</option>");
			}
		}
	}
}
//选择年月后出现相应的加工单
function getProcessed(getYear,getMonth){
	var getYarr=[];
	var arryTime=[];
	var yearNum=[];
	var fhtml="";
	for(var i=0;i<finshLength;i++){
		arryTime[i]=(finshJsonObj[i].startTime)  .substr(0,7);
	}
	for(var i=0;i<arryTime.length;i++){
		if(arryTime[i]==(getYear+"-"+getMonth)){
			var yearIndex=i;
			yearNum.push(yearIndex);
		}
	}
	for(var i=0;i<yearNum.length;i++){
		fhtml+="<li>";
		fhtml+="<div class=\"machNum\">"+finshJsonObj[yearNum[i]].machinNum+"</div>";
		fhtml+="<div class=\"modelName\">"+finshJsonObj[yearNum[i]].modelName+"</div>";
		fhtml+="<div class=\"mach_s_time\">"+finshJsonObj[yearNum[i]].startTime+"</div>";
		fhtml+="</li>";
	}
	$(".finishList").html(fhtml);
	$(".finishList").stop().slideDown();
}
//点击调到锚点
function goToCont(obj) {
	var boxHeight =$('header').height();
	var _targetTop_1 = $('.'+obj).offset().top - boxHeight - 20/72*num; //获取位置
	$('body,html').stop().animate({'scrollTop':_targetTop_1},1000)
}
function goToNav(index){
	var boxHeight =$('header').height();
	var _targetTop_2 = $('.listBox li').eq(index).offset().top - boxHeight-16/72*num; //获取位置
	$('body,html').stop().animate({'scrollTop':_targetTop_2},1000);
}

//————————————————————————————————筛选————————————————————————————————
//隐藏侧边栏
function hideNav(){
	$(".navMask").hide();
	$(".showNavIcon").stop().slideDown();
	$(".navList").removeClass("navShow");
	$(".listBtn").removeClass("BtnShow");
	$(".listTit").removeClass("BtnShow");
}
//展示子集
function showSon(obj,checkNum){
	obj.toggleClass('liClick').siblings().removeClass('liClick');
	var objVal = obj.find(".middleBox").html();
	var haveClass = obj.attr('class');
	var getNextObj = obj.parent().parent().parent().next();
	var getPrevObj = obj.parent().parent().prev();
	if(checkNum > 10){
		getNextObj.find(".curBox").hide();
		getNextObj.find('img').removeClass('imgclick');
		getNextObj.find('li').removeClass('liClick');
		getNextObj.stop().slideUp(function(){
			if(getNextObj.attr('id') == "cSonPlace"){
				getNextObj.find('span').html("选择子场地");
			}else{
				getNextObj.find('span').html("选择工序");
			}
		});
	}
	if(haveClass=="liClick"){
		getPrevObj.find('span').html(objVal);
		obj.parent().parent().parent().find('img').removeClass('imgclick');
		obj.parent().parent().stop().slideUp(500,function(){
			if(checkNum > 10){
				$(this).parent().next().stop().slideDown();
			}
		});
	}else{
		var getTitId = obj.parent().parent().parent().attr('id');
		if(getTitId == "cPlace"){
			getPrevObj.find('span').html('选择场地');
		}else if(getTitId == "cSonPlace"){
			getPrevObj.find('span').html('选择子场地');
		}else if(getTitId == "cModel"){
			getPrevObj.find('span').html('选择模板');
		}else if(getTitId == "cProcess"){
			getPrevObj.find('span').html('选择工序');
		}
		if(checkNum > 10){
			getNextObj.hide();
		}
	}	
}
//获取宽度
//function getWidth(){
//	var listW = [];
//	var maxWidth = 0;
//	for(var i=0;i<4;i++){
//		listW[i] = $('.curBox').eq(i).actual('width');
//		maxWidth = listW[i] < listW[i+1] ? listW[i+1] : listW[i];
//	}
////	console.log(maxWidth);
//	$(".navTit").css('width',maxWidth+'px');
//	$(".listBtn").css('width',maxWidth+'px');
//	$(".listTit").css('width',maxWidth+'px');
//}

//获取场地和子场地
function getPlace(getId,obj){
	$.ajax({
	    url: "js/place.json",
	    type: "GET",
	    dataType: "json",
	    success: function(data) {
	   		//遍历每个
	   		var placeObj = eval("data");
			var placeObjLength = placeObj.length;
	   		var phtml="";
	   		var psHtml = "";
	   		var haveChild = "";
	   		if(getId){
	   			psHtml+="<ul class=\"navListBox\">";
		   		for(var i=0;i<placeObjLength;i++){
		   			if(placeObj[i].siteId == getId){
		   				for(var a=0;a<placeObj[i].childSites.length;a++){
		   					psHtml+="<li id=\""+placeObj[i].childSites[a].childSiteId+"\"><div class=\"middleBox\">"+placeObj[i].childSites[a].childSiteName+"</div></li>";
		   					haveChild = placeObj[i].childSites[a];
		   				}
		   			}
		   		}
		   		psHtml+="</ul>";
		   		$(".cSonPlaceList").html(psHtml);
		   		//没有子场地时，不出现子场地选项
		   		if(haveChild){
		   			showSon(obj,100);
		   		}else{
		   			obj.parent().parent().parent().next().stop().slideUp();
		   			showSon(obj,1);
		   		}
		   		
	   		}else{
	   			phtml+="<ul class=\"navListBox\">";
		   		for(var i=0;i<placeObjLength;i++){
		   			phtml+="<li id=\""+placeObj[i].siteId+"\"><div class=\"middleBox\">"+placeObj[i].siteName+"</div></li>";
		   		}
		   		phtml+="</ul>";
		   		$(".cPlaceList").html(phtml);
	   		}
	    }
	});
}
//获取模板
function getModel(getId,obj){
	$.ajax({
	    url: "js/screen.json",
	    type: "GET",
	    dataType: "json",
	    success: function(data) {
	   		var modelObj = eval("data");
			var modelObjLength = modelObj.length;
	   		var mhtml="";
	   		var msHtml = "";
	   		var haveMChild = "";
	   		if(getId){
	   			msHtml+="<ul class=\"navListBox\">";
		   		for(var i=0;i<modelObjLength;i++){
		   			if(modelObj[i].tempId == getId){
		   				for(var a=0;a<modelObj[i].prcds.length;a++){
		   					msHtml+="<li id=\""+modelObj[i].prcds[a].prcdId+"\"><div class=\"middleBox\">"+modelObj[i].prcds[a].prcdName+"</div></li>";
		   					haveMChild = modelObj[i].prcds[a];
		   				}
		   			}
		   		}
		   		msHtml+="</ul>";
		   		$(".cProcessList").html(msHtml);
		   		//没有工序时，不出现选择工序
		   		if(haveMChild){
		   			showSon(obj,100);
		   		}else{
		   			obj.parent().parent().parent().next().stop().slideUp();
		   			showSon(obj,1);
		   		}
	   		}else{
	   			mhtml+="<ul class=\"navListBox\">";
		   		for(var i=0;i<modelObjLength;i++){
		   			mhtml+="<li id=\""+modelObj[i].tempId+"\"><div class=\"middleBox\">"+modelObj[i].tempName+"</div></li>";
		   		}
		   		mhtml+="</ul>";
		   		$(".cModelList").html(mhtml);
	   		}
	    }
	});
}
//————————————————————————————————筛选————————————————————————————————

